# DB의 기초
### DB(데이터베이스)란?

- 전자적으로 저장된 조직화된 데이터의 집합
- 한 조직에서 데이터를 체계적으로 저장, 검색, 관리, 공유하기 위해 사용

### RDB(관계형 데이터베이스)란?

- 데이터를 행과 열로 구성된 이차원 테이블 형식으로 저장, 각 테이블간의 관계를 정의
- 데이터를 정형화된 형식으로 저장
- SQL을 사용하여 데이터를 조회, 삽입, 수정, 삭제

### NoSQL(Not Only SQL)이란?

- NoSQL은 'Not Only SQL'의 약자로, 전통적인 관계형 데이터베이스 시스템의 제한을 벗어나기 위해 등장한 데이터베이스
- 저장 방식이 기존의 관계형 데이터베이스에 비해 훨씬 더 다양

# Vector DB
### Vector DB란?
- 비정형 데이터 특히 고차원 벡터 데이터를 처리하는 데 최적화된 데이터베이스
- RDB에서와 같이 데이터를 테이블 형식으로 구조화하는 것이 아닌 벡터 공간에서 데이터를 다루며 데이터를 고차원 벡터로 표현
- n차원 공간에서 근접 이웃 데이터를 효율적이고 빠르게 조회할 수 있는 기능을 추가

### 벡터란?
- 텐서의 하위 집합, 머신 러닝에서 n차원 공간에 있는 숫자 그룹을 가리키는 일반적인 용어
- 스칼라는 단일 숫자를 포함하는 0차원 텐서, 벡터는 동일한 유형을 여러 스칼라를 포함하는 1차원 텐서
- 벡터는 ML 모델에서 생성된 단어, 이미지, 동영상, 오디오와 같은 복잡한 객체를 나타낼 수 있음

- 벡터 데이터베이스는 벡터 공간에서 데이터를 다루며, 각 데이터는 고차원 벡터로 표현됨
- 즉, 수학적 특성을 이용해 데이터를 3차원 이상의 다차원 공간에 모델링함
- 입력한 쿼리 벡터와 가장 유사한 벡터를 찾는 유사도 검색 기반

### 임베딩 모델이란?
- 인공 지능과 머신 러닝의 혁신을 통해 일종의 ML 모델인 임베딩 모델 개발
- 텍스트, 이미지, 영상, 오디오 등 다양한 유형의 데이터를 컴퓨터가 이해하고 처리할 수 있도록 수치형태로 변환하는 방법, 즉 벡터로 인코딩
- 사람이 직접 정의하는 것이 아닌, 데이터를 AI 모델에 입력하면 모델 스스로 해당 데이터를 벡터로 변환
- 임베딩을 통해 데이터는 고차원 공간에서 저차원의 벡터로 변환됨

##### 자연어 처리에서의 벡터 임베딩

- 가장 잘 알려진 임베딩은 워드 임베딩(Word Embedding)
- 각 단어를 고유한 벡터로 표현하여 단어 간의 관계와 의미를 파악
- 벡터 공간에서 단어 간의 의미적 유사성을 수학적 연산을 통해 판단
- 대표적인 워드 임베딩 모델 : Word2Vec, BERT, GPT

##### 이미지 처리에서의 벡터 임베딩

- CNN(Convolutional Neural Network)을 통해 이미지의 픽셀값을 벡터로 변환
- 이를 통해 이미지에 포함된 다양한 정보와 의미를 보다 추상적인 형태로 표현할 수 있음

- 벡터 임베딩은 추천 시스템, LLM, 문서 요약, 감정 분석, 음성 인식 등 다양한 AI 분야에서 활용되고 있음
- 임베딩된 데이터를 효과적으로 저장하고 검색하기 위해 새로운 데이터 저장 방식이 필요됨

### 기존 데이터베이스 방식의 한계
1. 비정형 데이터 저장의 어려움
- RDB는 테이블 형태의 구조화된 데이터를 다루는데 적합
- AI의 발전으로 방대한 양의 비정형 데이터 생성. 비정형 데이터는 테이블에서 저장이 어려움

2. 유사성 검색의 한계
- RDB는 쿼리와 완전히 일치하는 행을 찾아 반환, 벡터 간의 유사성을 계산하고 검색하는 기능 부족

3. 대용량 데이터 처리의 제약
- 대규모의 벡터 데이터를 처리하는 것에 RDB는 성능 문제를 겪을 수 있음

- 벡터 데이터베이스는 방대한 양의 다차원 데이터를 벡터 형태로 저장하고 검색하도록 설계되었음.
- 벡터 임베딩은 의미상 관련된 항목을 벡터 공간에서 서로 가깝게 매핑하기 때문에 데이터 간의 유사성 검색을 신속하게 수행할 수 있음

### 벡터 데이터베이스 동작 원리
- 벡터 데이터베이스는 유사도 메트릭(Similarity Metrics)을 적용하여 가장 유사한 벡터를 검색

##### 벡터 데이터베이스의 파이프 라인
1. Indexing : PQ, LSH, HNSW와 같은 알고리즘을 사용하여 벡터를 인덱싱
더 빠른 검색을 위해 데이터 구조에 벡터를 매핑

2. 쿼리 : 유사도 메트릭을 적용하여 가장 가까운 벡터 검색
	- 코사인 유사도(Cosine Similarity) : 두 벡터 간의 각도를 측정하여 유사성 판단. 두 벡터가 얼마나 유사한 방향으로 향하고 있는지를 나타냄
	- 유클리디안 거리(Euclidean Distance) : 두 벡터 간의 직선 거리 측정. 거리가 짧을수록 유사성이 높다고 판단
	- 내적(Dot Product) : 두 벡터 간의 곱셈 연산을 통해 유사성 측정. 두 벡터의 방향이 유사한지 판단

3. 후처리 : 데이터셋에서 최종 최근접 이웃을 검색하고 이를 후처리하여 최종 결과 반환. 벡터 검색을 하기 전에 필터를 적용할 수도 있음
	- 사전 필터링 : 벡터를 검색하기 전 필터링 수행. 검색량을 줄이는 데 도움이 될 수 있지만 실제 연관이 있는 결과를 놓칠 수 있음. 광범위한 메타데이터 필터링으로 인해 쿼리 프로세스가 느려질 수 있음
	- 사후 필터링 : 벡터를 검색한 후 메타데이터 필터링 수행. 모든 결과를 추출하는데 도움이 되지만 검색 완료 후 결과를 필터링해야 하므로 추가 오버헤드가 발생하여 쿼리 프로세스가 느려짐.

* 메타데이터 : 데이터에 대한 데이터, 데이터를 설명하고 요약하는 정보
* 오버헤드 : 어떤 목적을 달성하기 위해 추가적으로 발생하는 간접적인 비용(시간, 메모리, 자원 등)

### 벡터 데이터베이스의 종류
- 대표적인 벡터 데이터베이스 : Pinecone, Weviate, Chroma, Qdrant, Milvus 등
- 벡터 데이터베이스 비교 정리 사이트 : https://discuss.pytorch.kr/t/2023-picking-a-vector-database-a-comparison-and-guide-for-2023/2625
https://www.superlinked.com/vector-db-comparison?utm_source=pytorchkr&ref=pytorchkr

- 비교 시 고려할 요소
	- 기능: 유사도 검색, 임베딩 지원 등 벡터 데이터베이스 고유의 기능. 
	- 성능 및 확장성: 대규모 데이터 처리 능력, 트래픽에 따른 확장성. 
	- 기존 인프라 활용: 기존 PostgreSQL 인프라와의 통합 가능 여부 (pgvector의 경우). 
	- 오픈소스 여부 및 라이선스: 오픈소스인 ChromaDB와 같은 솔루션의 장점. 
	- 사용 편의성: 개발자의 생산성과 편의성을 고려한 AI 네이티브 솔루션인지 여부. 

### 벡터 데이터베이스의 장점

- 최근접 이웃 검색을 효율적으로 수행도록 최적화되어 있어 대용량 데이터에서도 유사 항목을 빠르게 검색할 수 있음
- 방대한 양의 비정형 데이터를 저장하고 관리할 수 있음
- 빠른 데이터 검색을 가능하게 하기 때문에 모델 학습 속도를 높임
- 이미지, 동영상 등 다차원 데이터를 사용할 때의 복잡성을 처리할 수 있음

### 벡터 데이터베이스의 단점
- 벡터 차원이 높아질수록 검색 정확도가 떨어질 수 있음
- 비정형 데이터를 벡터 형태로 변환하고 이를 데이터베이스에서 처리하는 과정이 복잡
- 기존의 관계형 데이터베이스와 달리 시장에서 검증된 솔루션이나 숙련된 인력을 확보하기 어려움
- 비정형 데이터에서는 강점을 가지지만, 정형 데이터처럼 명확하고 일치된 값을 반환해야 하는 경우에 적합하지 않음
- 유사도 기반 검색이기 때문에 완벽한 답변이 아닌 최선의 유사한 결과를 제공할 수 있으며, 데이터 무결성을 관리하는데 어려움이 있음

* 워크로드 : 특정 작업을 완료하는 데 필요한 컴퓨팅 리소스(처리 능력, 메모리, 스토리지 등)의 양과 유형

* 참조 : https://blog.kbanknow.com/66
https://aws.amazon.com/ko/what-is/vector-databases/
https://www.ibm.com/kr-ko/think/topics/vector-database
https://brunch.co.kr/@harryban0917/336